<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xczhihui.medical.hospital.mapper.MedicalHospitalMapper">

	<!-- 通用查询结果列-->
	<!--<sql id="Base_Column_List">-->
		<!--id, name, age-->
	<!--</sql>-->
	<select id="selectHospitalList" resultType="com.xczhihui.medical.hospital.model.MedicalHospital">
		select * from medical_hospital mh
		<if test="field != null and field!=''">
			join medical_hospital_field mhf on mh.id = mhf.hospital_id and mhf.`field_id`=#{field}
		</if>
		where deleted = 0 and status = 1
		<if test="name != null and name!=''">
			and name like concat('%',#{name},'%')
		</if>
		ORDER BY authentication DESC, score DESC
	</select>

	<select id="getHotField" resultType="com.xczhihui.medical.field.model.MedicalField">
		SELECT
		  mf.id,mf.name
		FROM
		  `medical_field` mf
		  LEFT JOIN `medical_hospital_field` mhf
			ON mf.`id` = mhf.`field_id`
		GROUP BY mhf.`field_id`
		ORDER BY COUNT(mhf.`field_id`) DESC
		LIMIT 0, 10
	</select>

	<select id="selectRecHospital" resultType="com.xczhihui.medical.hospital.model.MedicalHospital">
		select
		  *
		from
		  medical_hospital
		where deleted = 0
		  and status = 1
		  and recommend = 1
		order by recommend_sort desc
		limit 0, 6
	</select>

	<select id="selectHospitalById" resultType="com.xczhihui.medical.hospital.model.MedicalHospital">
		select *,detailed_address detailedAddress from medical_hospital where deleted = 0 and status = 1 and id = #{id}
	</select>

	<select id="selectMedicalFieldsByDoctorId" resultType="com.xczhihui.medical.field.model.MedicalField">
		SELECT
		mf.name,
		mf.id
		FROM
		`medical_field` mf,
		`medical_hospital_field` mhf
		WHERE mf.`id` = mhf.`field_id`
		and mhf.hospital_id = #{hospitalId}
	</select>
</mapper>