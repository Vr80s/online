function delDialog(n){var t=$(n).parent().parent().parent(),i=questionTable.fnGetData(t);showDelDialog(function(){ajaxRequest("question/delete",{id:i.id},function(n){alertMsg(n.errorMessage);freshTable(questionTable)})})}function deleteBatch(){deleteAll("question/deleteBatch",questionTable)}function search(){searchButton(questionTable,searchCase)}function isContained(n,t){if(!(t instanceof Array))return!1;for(var i=0,r=t.length;i<r;i++)if(n==t[i])return!0;return!1}function ajaxCallback(n){n.success?(alertMsg(n.errorMessage),location.reload()):alertMsg(n.errorMessage)}function selectFile1(n){var t=$(n);t.parent("#wysiwygEditorAnswer").find("#answerNomalAttachment").click()}function selectFile2(n){var t=$(n);t.parent("#wysiwygEditorAnswer").find("#practicalNomalAttachment").click()}function toReset(){$(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected");$("#question-form #ksystemId").val("").trigger("chosen:updated");$("#ksystemId").val("");$("#knowledgeNames").val("");$("#qKeyword").val("");$("#knowledgeIds").val("");$("#questionSolutionValue").empty();$("#questionSolutionValue").html(solution);var n=$("input[type='radio']:checked").val();n==0?($("input[type='radio']").eq(0).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionOptionValue").html(multipleOne),createImageUpload($(".uploadImg")),$("#questionContentValue").html(contentTypeNoFilling),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==1?($("input[type='radio']").eq(1).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionOptionValue").html(multipleMany),createImageUpload($(".uploadImg")),$("#questionContentValue").html(contentTypeNoFilling),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==2?($("input[type='radio']").eq(2).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(answerJudge),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==3?($("input[type='radio']").eq(3).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeFilling),wysiwygEditorFilling=createKindEdit('#wysiwygEditorFilling textarea[class="kindeditor"]',editAfterBulrBlank),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==4?($("input[type='radio']").eq(4).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(answerNomal),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]'),wysiwygEditorAnswer=createKindEdit('#wysiwygEditorAnswer textarea[class="kindeditor"]',editAfterBulrAnswer)):n==5?($("input[type='radio']").eq(5).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(answerAttachment),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==6&&($("input[type='radio']").eq(6).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(practical),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]'));$("input[name='status']").eq(0).attr("checked",!0);$("input[name='difficulty']").eq(0).attr("checked",!0)}function submitToAdd(n){var t,u,f,i,o,r,s,e,h,c;if($("#addButton1").attr("disabled",!0),$("#addButton2").attr("disabled",!0),$("#addButton3").attr("disabled",!0),t=$("input[type='radio']:checked").val(),isnull(wysiwygEditorSolution.text())?$("#question-form #solution").val(""):$("#question-form #solution").val(wysiwygEditorSolution.html()),$("#divText").html(wysiwygEditorSolution.html()),$("#question-form #solutionText").val($("#divText").text()),t==0||t==1||t==2?(isnull(wysiwygEditorNoFilling.text())?$("#question-form #questionHeadNoFilling").val(""):$("#question-form #questionHeadNoFilling").val(wysiwygEditorNoFilling.html()),$("#divText").html(wysiwygEditorNoFilling.html()),$("#question-form #questionHeadNoFillingText").val($("#divText").text())):t==3?(isnull(wysiwygEditorFilling.text())?$("#question-form #questionHeadFilling").val(""):$("#question-form #questionHeadFilling").val(wysiwygEditorFilling.html()),$("#divText").html(wysiwygEditorFilling.html()),$("#question-form #questionHeadFillingText").val($("#divText").text())):t==4?(isnull(wysiwygEditorNoFilling.text())?$("#question-form #questionHeadNoFilling").val(""):$("#question-form #questionHeadNoFilling").val(wysiwygEditorNoFilling.html()),isnull(wysiwygEditorAnswer.text())?$("#question-form #answer").val(""):$("#question-form #answer").val(wysiwygEditorAnswer.html()),$("#divText").html(wysiwygEditorNoFilling.html()),$("#question-form #questionHeadNoFillingText").val($("#divText").text()),$("#divText").html(wysiwygEditorAnswer.html()),$("#question-form #answerText").val($("#divText").text())):(t==5||t==6)&&(isnull(wysiwygEditorNoFilling.text())?$("#question-form #questionHeadNoFilling").val(""):$("#question-form #questionHeadNoFilling").val(wysiwygEditorNoFilling.html()),$("#divText").html(wysiwygEditorNoFilling.html()),$("#question-form #questionHeadNoFillingText").val($("#divText").text())),$("#question-form").valid()||($("#addButton1").attr("disabled",!1),$("#addButton2").attr("disabled",!1),$("#addButton3").attr("disabled",!1)),$("#question-form").valid()){if(u=[],t==0&&$("#chooseOption1_ul").find("[name^='radioOptionValue']").each(function(){if(-1<$.inArray(this.value,u))return $("#choose_answer_option").append(OptionRepeatError),$("#addButton1").attr("disabled",!1),$("#addButton2").attr("disabled",!1),$("#addButton3").attr("disabled",!1),u=!1,!1;isnull(this.value)||u.push(this.value)}),!u)return;if(f=[],t==1&&$("#multipleOption1_ul").find("[name^='multipleOption']").each(function(){if(-1<$.inArray(this.value,f))return $("#addButton1").attr("disabled",!1),$("#addButton2").attr("disabled",!1),$("#addButton3").attr("disabled",!1),$("#multipleOption1_ul").append(OptionRepeatError),f=!1,!1;isnull(this.value)||f.push(this.value)}),!f)return;if(t==0){if(!validateOption())return!1;if(i=$('input:radio[name="radioOption"]:checked').val(),i===undefined||i.length<1)return $("#addButton1").attr("disabled",!1),$("#addButton2").attr("disabled",!1),$("#addButton3").attr("disabled",!1),$("#choose_answer_option").append(singleError),!1}else if(t==1){if(!validateOption())return!1;if(i=[],$('input[name="multipleOption"]:checked').each(function(){i.push($(this).val())}),i===undefined||i.length<2)return $("#addButton1").attr("disabled",!1),$("#addButton2").attr("disabled",!1),$("#addButton3").attr("disabled",!1),$("#multipleOption1_ul").append(multiplError),!1}if(t==3)if(o=$("#question-form #questionHeadFilling").val(),console.log(o),r=o.match(/【([^【^】]+)】/g),s=o.match(/【】/g),r!=null&&r.length>0&&!(s!=null&&s.length!=0)){for(e=0;e<r.length;e++)if(h=r[e].substring(1,r[e].length-1),isnull($.trim(h.replace(/&nbsp;/g,""))))return $("#addButton1").attr("disabled",!1),$("#addButton2").attr("disabled",!1),$("#addButton3").attr("disabled",!1),$("#fillingError").append(fillingError),!1}else return $("#addButton1").attr("disabled",!1),$("#addButton2").attr("disabled",!1),$("#addButton3").attr("disabled",!1),$("#fillingError").append(fillingError),!1;c=$("#question-form").serialize();ajaxRequest(basePath+"/question/add",c,function(t){t.success&&(n==1&&turnPage(basePath+"/home#questionsub/index?ksystemId="+t.resultObject.ksystemId),n==2&&turnPage(basePath+"/home#question/toAdd?ksystemId="+t.resultObject.ksystemId+"&time="+(new Date).getTime()))})}}function manageDialogAdd(n){var t=$(n).parent().parent().parent(),u=questionTable.fnGetData(t),i=$("#question-form #ksystemId").val(),r=$("#question-form #knowledgeIds").val();dialog=openDialog("knowledgeDialog","knowledgeDialogDiv","知识体系设置",730,460,!0,"保存",saveKnowledge);clearTree();initCommonZtrees("leftResource","rightResource","question/findDataForTreeRight",{knowledgeIds:r},"right",function(){initCommonZtrees("leftResource","rightResource","question/findDataForTreeLeft",{ksystemId:i},"left")})}function saveKnowledge(){viewRightTree(function(n){var t=[],i=[];$(n).each(function(n,r){t.push(r.id);i.push(r.name)});$("#question-form #knowledgeNames").val(i);$("#question-form #knowledgeIds").val(t);dialog.dialog("close")})}function multiDelete(n){var i=$(n).closest("li").nextAll(),t,r;if($(n).closest("li").remove(),i.length>0)for(t=0;t<i.length;t++)r=OptionIndex[$(i[t]).index()],$(i[t]).find("span").first().html(r+"："),$(i[t]).find("input[name='multipleOption']").val(r),$(i[t]).find("input[id^='imgFile']").attr("id","imgFile"+($(i[t]).index()+1)),$(i[t]).find("input[id^='uploadify']").attr("id","uploadify"+($(i[t]).index()+1)),$(i[t]).find("input[name^='uploadify']").attr("name","uploadify"+($(i[t]).index()+1)),$(i[t]).find("input[name^='multipleOptionValue']").attr("name","multipleOptionValue"+($(i[t]).index()+1));validateOption()}function singleDelete(n){var i=$(n).closest("li").nextAll(),t,r;if($(n).closest("li").remove(),i.length>0)for(t=0;t<i.length;t++)r=OptionIndex[$(i[t]).index()],$(i[t]).find("span").first().html(r+"："),$(i[t]).find("input[name='radioOption']").val(r),$(i[t]).find("input[id^='imgFile']").attr("id","imgFile"+($(i[t]).index()+1)),$(i[t]).find("input[id^='uploadify']").attr("id","uploadify"+($(i[t]).index()+1)),$(i[t]).find("input[name^='uploadify']").attr("name","uploadify"+($(i[t]).index()+1)),$(i[t]).find("input[name^='radioOptionValue']").attr("name","radioOptionValue"+($(i[t]).index()+1));validateOption()}function addRadio(){var t="",i=$("#chooseOption1_ul").children("li").last().find("input[name='radioOption']").attr("value"),n;for(i=="K"&&($("#singleHintDiv").empty(),$("#singleHintDiv").append(OptionMaxError)),n=0;n<OptionIndex.length;n++)if(n>=OptionIndex.length-1)$(".mengban").show(),$(".prompt").show();else if(i==OptionIndex[n]){t+='<li><div class="dw"><div class="col-xs-3 paddingleft0px paddingright0px">    \t                    <input type="radio" value="'+OptionIndex[n+1]+'"                           name="radioOption"><span style="width:20px;display:inline-block">'+OptionIndex[n+1]+'：<\/span>                          <input name="radioOptionValue'+(n+2)+'" type="text" style="width:80%" value="" maxlength="3000">                         <\/div><div class="form-group">\t\t\t          \t<div class="col-xs-1 ">\t\t\t          \t<input type="hidden" name="uploadify'+(n+2)+'" id="uploadify'+(n+2)+'"  >\t\t\t\t\t\t<input type="file"   name="attachment" id="imgFile'+(n+2)+'" class="uploadImg" value="" />\t\t\t          \t<\/div>\t\t\t          \t<div  class="col-xs-1 paddingleft0px paddingright0px control-label no-padding-right"><input type="button" class="answer_delete_btn chooseOption1_delete_btn" value="删除" onclick="singleDelete(this)"\t\t\t          \t<\/div>\t\t\t          \t<\/div>              <\/li>';break}$("#chooseOption1_ul").append(t);createImageUpload($("#imgFile"+(n+2)));$(".remove").click(function(){console.info($(this).closest("div"));console.info($(this).closest("div").find("input:hidden"));$(this).closest("div").find("input:hidden").val("");validateOption()});validateOption()}function addCheckbox(){var t="",i=$("input[name='multipleOption']").last().attr("value"),n;for(i=="K"&&($("#multipleHintDiv").empty(),$("#multipleHintDiv").append(OptionMaxError)),n=0;n<OptionIndex.length;n++)if(n>=OptionIndex.length-1)$(".mengban").show(),$(".prompt").show();else if(i==OptionIndex[n]){t+='<li><div class="dw"><div class="col-xs-3 paddingleft0px paddingright0px">\t\t\t        \t          <input type="checkbox" class="question_options_check" value="'+OptionIndex[n+1]+'"\t\t\t                       name="multipleOption"><span style="width:20px;display:inline-block">'+OptionIndex[n+1]+'：<\/span>\t\t\t                       <input name="multipleOptionValue'+(n+2)+'" type="text" style="width:80%;" value="" maxlength="3000">\t\t\t        \t\t      <\/div> <div class="form-group">\t\t\t        \t\t   \t  <div class="col-sm-1 ">\t\t\t        \t\t   \t  <input type="hidden" name="uploadify'+(n+2)+'" id="uploadify'+(n+2)+'"  >\t\t\t\t\t\t\t\t  <input type="file"   name="attachment" id="imgFile'+(n+2)+'" class="uploadImg" value="" />\t\t\t        \t\t   \t   <\/div>\t\t\t        \t\t   \t   <div class="col-xs-1 paddingleft0px paddingright0px control-label no-padding-right"><input type="button" class="answer_delete_btn chooseOption1_delete_btn" value="删除" onclick="multiDelete(this)"\t\t\t        \t\t   \t<\/div>\t\t\t        \t\t   \t<\/div>                       <\/li>';break}$("#multipleOption1_ul").append(t);createImageUpload($("#imgFile"+(n+2)));$(".remove").click(function(){console.info($(this).closest("div"));console.info($(this).closest("div").find("input:hidden"));$(this).closest("div").find("input:hidden").val("");validateOption()});validateOption()}function validateImgSize(n,t){var r=$("#"+n).val(),i;return!isnull(r)&&(i=fileChangeGetSize(document.getElementById(n)),i>t)?!1:!0}function fileChangeGetSize(n){var r=/msie/i.test(navigator.userAgent)&&!window.opera,t=0;if(r&&!n.files){var u=n.value,f=new ActiveXObject("Scripting.FileSystemObject"),i=fileobject.GetFile(n.value),e=i.Size;t=i.Size}else t=n.files[0].size;return t/1048576}function editAfterBulr(){isnull(wysiwygEditorNoFilling.text())?$("#question-form #questionHeadNoFilling").val(""):$("#question-form #questionHeadNoFilling").val(wysiwygEditorNoFilling.html());$("#question-form").validate().element($("#questionHeadNoFilling"))}function editAfterBulrBlank(){isnull(wysiwygEditorFilling.text())?$("#question-form #questionHeadFilling").val(""):$("#question-form #questionHeadFilling").val(wysiwygEditorFilling.html());$("#question-form").validate().element($("#questionHeadFilling"))}function editAfterBulrAnswer(){isnull(wysiwygEditorAnswer.text())?$("#question-form #answer").val(""):$("#question-form #answer").val(wysiwygEditorAnswer.html());$("#question-form").validate().element($("#answer"))}function validateChooseOption(){$("#choose_answer_option").find(".error").remove();var n=!0,t=$("#chooseOption1_ul").children("li");return $(t).each(function(){if(isnull($(this).find("input[name^='radioOptionValue']").val())&&isnull($(this).find("input[id^='uploadify']").val())){n=!1;return}}),n?!0:($("#editButton").attr("disabled",!1),$("#choose_answer_option").append(optionBlankError),!1)}function validateMultipleOption(){$("#multiple_answer_option").find(".error").remove();var n=!0,t=$("#multipleOption1_ul").children("li");return $(t).each(function(){if(isnull($(this).find("input[name^='multipleOptionValue']").val())&&isnull($(this).find("input[id^='uploadify']").val())){n=!1;return}}),n?!0:($("#editButton").attr("disabled",!1),$("#multiple_answer_option").append(optionBlankError),!1)}function validateOption(){var n=$('input[name="questionType"]').filter(":checked").val();return n=="0"?validateChooseOption():n=="1"?validateMultipleOption():void 0}var objData,questionForm,editFormEl="#question-edit-form",editValidateForm,OptionIndex=["A","B","C","D","E","F","G","H","I","J","K"],wysiwygEditorNoFilling,wysiwygEditorSolution,wysiwygEditorFilling,wysiwygEditorAnswer;$(function(){objData=[{title:createAllCheckBox(),"class":"center",data:"id",sortable:!1,width:"5%",mRender:function(n){return createCheckBox(n)}},{title:"序号","class":"center",sortable:!1,data:"id",width:"90px"},{title:"题目编号","class":"center",width:"90px",sortable:!1,data:"questionNo",visible:!1},{title:"类型","class":"center",sortable:!1,data:"questionType",mRender:function(n){return"0"==n?"单选题":"1"==n?"多选题":"2"==n?"判断题":"3"==n?"填空题":"4"==n?"简答题":"5"==n?"代码题":void 0}},{title:"状态","class":"center",sortable:!1,data:"status",mRender:function(n){return"0"==n?"禁用":"1"==n?"启用":void 0}},{title:"难度","class":"center",sortable:!1,data:"difficulty"},{title:"录入人","class":"center",sortable:!1,data:"inputPerson"},{title:"知识点数","class":"center",sortable:!1,data:"relatedKponitNumber"},{title:"知识点","class":"center",sortable:!1,data:"kpointNames"},{title:"创建时间","class":"center",sortable:!1,data:"createTimeStr"},{sortable:!1,"class":"center",width:"10%",title:"操作",mRender:function(){return'<div class="hidden-sm hidden-xs action-buttons"><a class="blue" href="javascript:void(-1);" title="修改" onclick="editDialog(this)"><i class="ace-icon fa fa-pencil bigger-130"><\/i><\/a><a class="blue" href="javascript:void(-1);" title="预览" onclick="previewDialog(this)"><i class="ace-icon fa fa-search bigger-130"><\/i><\/a><a class="red" href="javascript:void(-1);" title="删除" onclick="delDialog(this)"><i class="ace-icon fa fa-trash-o bigger-130"><\/i><\/a><\/div>'}}];questionTable=initTables("questionTable","question/load/question",objData,!0,!0,2,null,null);questionForm=$("#question-form").validate({messages:{questionHead:{required:"题干不能为空"},inputPerson:{required:"录入人不能为空"},ksystemId:{required:"知识体系不能为空"},knowledgeNames:{required:"知识点不能为空"},answerAttachment:{required:"附件不能为空"}},errorPlacement:function(n,t){n.appendTo(t.parent())}});editValidateForm=$(editFormEl).validate({messages:{}})});$(function(){var n;$("#questionOptionValue").html(multipleOne);createImageUpload($(".uploadImg"));$("#questionContentValue").html(contentTypeNoFilling);$("#questionSolutionValue").html(solution);wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr);wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]');$("#qustion_type :radio").click(function(){$("#questionSolutionValue").empty();$("#questionSolutionValue").html(solution);var n=$("input[type='radio']:checked").val();n==0?($(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected"),$("#knowledgeNames").val(""),$("#knowledgeIds").val(""),$("input[type='radio']").eq(0).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionOptionValue").html(multipleOne),createImageUpload($(".uploadImg")),$("#questionContentValue").html(contentTypeNoFilling),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]'),console.info($(".remove")),$(".remove").click(function(){console.info($(this).closest("div"));console.info($(this).closest("div").find("input:hidden"));$(this).closest("div").find("input:hidden").val("");validateOption()})):n==1?($(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected"),$("#knowledgeNames").val(""),$("#knowledgeIds").val(""),$("input[type='radio']").eq(1).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionOptionValue").html(multipleMany),createImageUpload($(".uploadImg")),$("#questionContentValue").html(contentTypeNoFilling),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]'),console.info($(".remove")),$(".remove").click(function(){console.info($(this).closest("div"));console.info($(this).closest("div").find("input:hidden"));$(this).closest("div").find("input:hidden").val("");validateOption()})):n==2?($(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected"),$("#knowledgeNames").val(""),$("#knowledgeIds").val(""),$("input[type='radio']").eq(2).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(answerJudge),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==3?($(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected"),$("#knowledgeNames").val(""),$("#knowledgeIds").val(""),$("input[name='status']").eq(0).attr("checked",!0),$("input[name='difficulty']").eq(0).attr("checked",!0),$("input[type='radio']").eq(3).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeFilling),wysiwygEditorFilling=createKindEdit('#wysiwygEditorFilling textarea[class="kindeditor"]',editAfterBulrBlank),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==4?($(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected"),$("#knowledgeNames").val(""),$("#knowledgeIds").val(""),$("input[type='radio']").eq(4).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(answerNomal),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]'),wysiwygEditorAnswer=createKindEdit('#wysiwygEditorAnswer textarea[class="kindeditor"]',editAfterBulrAnswer)):n==5?($(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected"),$("#knowledgeNames").val(""),$("#knowledgeIds").val(""),$("input[type='radio']").eq(5).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(answerAttachment),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]')):n==6&&($(":input","#subject-form").not(":button, :submit, :reset").val("").removeAttr("checked").removeAttr("selected"),$("#knowledgeNames").val(""),$("#knowledgeIds").val(""),$("input[type='radio']").eq(6).attr("checked",!0),$("#questionOptionValue").empty(),$("#questionContentValue").empty(),$("#questionAnswerValue").empty(),$("#questionContentValue").html(contentTypeNoFilling),$("#questionAnswerValue").html(practical),wysiwygEditorNoFilling=createKindEdit('#wysiwygEditorNoFilling textarea[class="kindeditor"]',editAfterBulr),wysiwygEditorSolution=createKindEdit('#wysiwygEditorSolution textarea[class="kindeditor"]'))});$("#question-form").on("change",".uploadImg",function(){var i,t;if(n=this,i=this.value.split(".")[1].toUpperCase(),i!="BMP"&&i!="GIF"&&i!="JPEG"&&i!="PNG"&&i!="SVG"&&i!="JPG"){alertMsg("图片格式错误,请重新选择.");this.value="";return}t=$(this).attr("id");ajaxFileUpload(this.id,basePath+"/attachmentCenter/upload?projectName=kcenter&fileType=2",function(i){var r,u;$("#"+t).parent().find(".ace-file-name img").length==0&&($("#"+t).parent().find(".ace-file-name").append('<img class="middle"><i class=" ace-icon fa fa-picture-o file-image"><\/i>'),$("#"+t).parent().find(".ace-file-container").addClass("selected"),$("#"+t).parent().find(".ace-file-container").addClass("hide-placeholder"),$("#"+t).parent().find(".ace-file-container").removeAttr("data-title"),r=n.value.substring(n.value.lastIndexOf("\\")+1),$("#"+t).parent().find(".ace-file-name").attr("data-title",r));$("#"+t).parent().find(".ace-file-name img").attr("style","width: 50px; height: 50px;");$("#"+t).parent().find(".ace-file-name img").attr("src",basePath+"/attachmentCenter/download?aid="+i.id);$("#"+t).parent().parent("div").find("input:hidden").val(i.id);u=t.replace("imgFile","uploadify");$("#"+u).val(i.id);validateOption()})});$("#question-form").on("change","#answerNomalAttachment",function(){var r,t,i;if(n=this,r=this.value.split("."),t=r[r.length-1].toUpperCase(),t!="TXT"&&t!="DOC"&&t!="DOCX"&&t!="XLS"&&t!="XLSX"&&t!="ZIP"&&t!="RAR"){alertMsg("请上传txt,word,excel,zip,rar的附件格式.");this.value="";return}if(i=$(this).attr("id"),!validateImgSize(i,100))return alertMsg("附件大于100M,请重新选择."),this.value="",!1;mask("附件正在上传,请等待");ajaxFileUpload(this.id,basePath+"/attachmentCenter/upload?projectName=kcenter&fileType=2",function(n){unmask();$("#answerNomalAttachment").hide();$("#wysiwygEditorAnswer").find(".show").remove();$("#wysiwygEditorAnswer").append('<span class="show" onclick="selectFile1(this)">'+n.orgFileName+"<\/span>");$("#"+i).attr("value",n.fileName);$("#"+i).parent().parent("div").find("#answerAttachment").val(n.id)})});$("#question-form").on("change","#practicalNomalAttachment",function(){var r,t,i;if(n=this,r=this.value.split("."),t=r[r.length-1].toUpperCase(),t!="TXT"&&t!="DOC"&&t!="DOCX"&&t!="XLS"&&t!="XLSX"&&t!="ZIP"&&t!="RAR"&&t!="BMP"&&t!="GIF"&&t!="JPEG"&&t!="PNG"&&t!="SVG"&&t!="JPG"){alertMsg("请上传txt,word,excel,zip,rar或者图片的附件格式.");this.value="";return}if(i=$(this).attr("id"),!validateImgSize(i,500))return alertMsg("素材大于500M,请重新选择."),this.value="",!1;mask("素材正在上传,请等待");ajaxFileUpload(this.id,basePath+"/attachmentCenter/upload?projectName=kcenter&fileType=2",function(n){unmask();$("#practicalNomalAttachment").hide();$("#wysiwygEditorAnswer").find(".show").remove();$("#wysiwygEditorAnswer").append('<span class="show" onclick="selectFile2(this)">'+n.orgFileName+"<\/span>");$("#"+i).attr("value",n.fileName);$("#"+i).parent().parent("div").find("#practicalAttachment").val(n.id)})});console.info($(".remove"));$(".remove").click(function(){console.info($(this).closest("div"));console.info($(this).closest("div").find("input:hidden"));$(this).closest("div").find("input:hidden").val("");validateOption()})});OptionIndex=["A","B","C","D","E","F","G","H","I","J","K"];$("#ksystemId").bind("change",function(){$("#question-form").validate().element($("#ksystemId"))});$("#question-form").on("change","#questionOptionValue input[name^='radioOptionValue']",function(){validateOption()});$("#question-form").on("change","#questionOptionValue input[name^='multipleOptionValue']",function(){validateOption()})