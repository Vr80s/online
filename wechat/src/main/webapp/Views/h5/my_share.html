<!-- <%@ page pageEncoding="UTF-8"%>  -->
<!DOCTYPE html>
<html>
	<head>
		<meta content="text/html; charset=utf-8">
		<title>我的分享</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="/Views/h5/css/mui.min.css">
		<link rel="stylesheet" href="/Views/h5/css/common.css">
		<link rel="stylesheet" type="text/css" href="/Views/h5/font/iconfont.css" />
		<style>
			.mui-control-content {
				background-color: white;
			
			}
			.mui-control-content .mui-loading {
				margin-top: 50px;
			}
			.shcoolmoney{
				width: 100%;
			}
			.shcoolmoney >p>span:last-child{
				float:right;
			}
			.stuname{
				margin-right: 15px;
			}
			#parentName{
				font-size:25px;
			}
			#myBroker{
				color:#ff265a;
				font-size:25px;
			}
			#sliderSegmentedControl a{
				line-height: 50px;
				font-size: 17px;
			}
		</style>
	</head>
	<body>
		<div class="mui-content">
			<div class="mui-table-view">
				<div class="mui-table-view-cell" style="height: 180px; margin-top: -20px;border-bottom:1px dashed #EDEDED">
					<p style="font-size: 17px;margin-top: 10%; margin-left: 15%;color: black;"><i class="iconfont icon-zhanghuwenti" style="color: #6acc93;font-size: 28px;"></i>我的上级合伙人：<span id="parentName"></span></p>
					<p style="font-size: 17px;margin-top: 10%; margin-left: 15%;color: black;"><i class="iconfont icon-jiekuanwenti" style="color: #6acc93;font-size: 28px;"></i>我的学费补贴：<span id="myBroker"></span></p>
				</div>
				<div style="height: 40px;line-height: 40px;font-size: 12px;text-align: center;color: #999;">
					当天的佣金将于第二天凌晨03:00后计算更新
				</div>
			</div>
			
			<div id="slider" class="mui-slider" style="background: white;margin-top: 10px;">
				<div id="sliderSegmentedControl"  class="mui-slider-indicator mui-segmented-control mui-segmented-control-inverted mui-segmented-control-positive">
					<a class="mui-control-item mui-active" href="#item1mobile">我的合伙人</a>
					<a class="mui-control-item" href="#item2mobile">学费补贴</a>
				</div>
				<div id="sliderProgressBar" class="mui-slider-progress-bar mui-col-xs-6"></div>
				<div class="mui-slider-group">
					<div id="item1mobile" class="mui-slider-item mui-control-content mui-active">
						<div id="scroll1" class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view mui-table-view-chevron" id="partnerList">
									<!--<li class="mui-table-view-cell mui-collapse">
										<a class="mui-navigate-right" href="#">
											<div class="shcoolmoney" style="">
												<p><span class="stuname">王立斌</span>15912354856  <span style="float: right;">2017-02-25</span></p>
											</div>
										</a>
										<ul class="mui-table-view mui-table-view-chevron">
											<li class="mui-table-view-cell">
												<div class="shcoolmoney" style="">
													<p><span class="stuname">一级合伙人：15人</span><span style="float: right;">二级合伙人：30人</span></p>
												</div>
											</li>
										</ul>
									</li>-->
								</ul>
							</div>
						</div>
					</div>
					<div id="item2mobile" class="mui-slider-item mui-control-content">
						<div id="scroll2" class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul class="mui-table-view" id="brokerList">
									<!--<li class="mui-table-view-cell">
										<div class="shcoolmoney" style="">
											<p><span class="stuname">王立斌</span>15912354856  <span style="float: right;">+255</span></p>
											<p>2018-09-89 24:99:99<span style="float: right;">+255</span></p>
										</div>
									</li>-->
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			
		</div>
		<script src="/Views/h5/js/mui.min.js"></script>
		<script type="text/javascript" src="/Views/h5/js/common.js"></script>
		<script>
			mui.init({
				swipeBack: false
			});
			var useid = localStorage.useid;
			(function($) {
				$('.mui-scroll-wrapper').scroll({
					indicators: true //是否显示滚动条
				});				
				var sliderSegmentedControl = document.getElementById('sliderSegmentedControl');
				$('.mui-input-group').on('change', 'input', function() {
					if (this.checked) {
						sliderSegmentedControl.className = 'mui-slider-indicator mui-segmented-control mui-segmented-control-inverted mui-segmented-control-' + this.value;
						sliderProgressBar.setAttribute('style', sliderProgressBar.getAttribute('style'));
					}
				});	
				
				//请求数据--我的上级 合伙人及我的学费补贴
				requestService("/bxg/share/brokerage",{userId:useid},function(data) {
					if(data.success){
						document.getElementById("parentName").innerText=data.resultObject.username==null?"无":data.resultObject.username;
						document.getElementById("myBroker").innerText=data.resultObject.subsidies==null?"￥0.00":"￥"+data.resultObject.subsidies;
					}
				})
				//请求数据--我的合伙人列表
				requestService("/bxg/share/partnerList",{userId:useid},function(data) {
					if(data.success){
						var obj = document.getElementById("partnerList");
						if(data.resultObject.length!=0){							
							var len = data.resultObject.length;
							for(var i=0;i<len;i++){
								obj.innerHTML+='<li class="mui-table-view-cell mui-collapse">'+
								'<a class="mui-navigate-right" href="#">'+
								'<div class="shcoolmoney" style=""><p><span class="stuname">'+
								data.resultObject[i].name+'</span>'+data.resultObject[i].mobile+'  <span style="float: right;">'+data.resultObject[i].create_time+'</span></p></div></a>'+
								'<ul class="mui-table-view mui-table-view-chevron">'+
								'<li class="mui-table-view-cell">'+
								'<div class="shcoolmoney"><p><span class="stuname">一级合伙人：'+data.resultObject[i].countMap.count_l1+'人</span>'+
								'<span style="float: right;">二级合伙人：'+(data.resultObject[i].countMap.count_l2==null?0:data.resultObject[i].countMap.count_l2)+'人</span></p></div>'+
								'</li></ul></li>';
							}
						}else{
							obj.innerHTML="<span style='margin-left:20px;padding-top:200px;font-size:12px;'>~抱歉，暂无数据</span>";	
						}											
					}
				})
				//请求数据--我的学费补贴
				requestService("/bxg/share/brokerageList",{userId:useid},function(data) {
					if(data.success){
						var obj = document.getElementById("brokerList");
						if(data.resultObject.length!=0){								
							var len = data.resultObject.length;
							for(var i=0;i<len;i++){
								var lev = "";
								if((parseInt(data.resultObject[i].level)+1)==1){
									lev = "一";
								}else if((parseInt(data.resultObject[i].level)+1)==2){
									lev = "二";
								}else if((parseInt(data.resultObject[i].level)+1)==3){
									lev = "三";
								}
								
								obj.innerHTML+='<li class="mui-table-view-cell"><a href="/bxg/page/my_share_detail/'+data.resultObject[i].id+'"><div class="shcoolmoney">'+
									'<p><span class="stuname">'+data.resultObject[i].name+'</span>'+data.resultObject[i].mobile+'<span style="float: right;">+'+data.resultObject[i].subsidies+'</span></p>'+
									'<p>'+data.resultObject[i].pay_time+'<span style="float: right;">'+lev+'级</span></p></div></a></li>'
							}
						}else{
							obj.innerHTML="<span style='margin-left:20px;padding-top:200px;font-size:12px;'>~抱歉，暂无数据</span>";
						}						
					}
				})
			})(mui);
			window.addEventListener('toggle', function(event) {
				if (event.target.id === 'M_Toggle') {
					var isActive = event.detail.isActive;
					var table = document.querySelector('.mui-table-view');
					var card = document.querySelector('.mui-scroll');
					if (isActive) {
						card.appendChild(table);
						card.style.display = '';
					} else {
						var content = document.querySelector('.mui-content');
						content.insertBefore(table, card);
						card.style.display = 'none';
					}
				}
			});
			//查看详情
			function showDetail(id){
				window.location.href="/Views/h5/"
			}
			var height =  document.body.clientHeight;
			var contentheight = height -285;
			document.getElementById("item1mobile").setAttribute("style","height:"+contentheight+"px;");
			document.getElementById("item2mobile").setAttribute("style","height:"+contentheight+"px;");
		</script>
	</body>
</html>