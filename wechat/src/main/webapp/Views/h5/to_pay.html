<%@page pageEncoding="UTF-8"%> 
<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>云课堂-熊猫中医</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="/Views/h5/css/mui.min.css">
		<link rel="stylesheet" href="/Views/h5/css/common.css">
		<style>
			.btn_div {
				width: 100%;
				height: 20px;
				position: absolute;
				margin-top: 0px;
				z-index: 10000;
			}
			
			.mui-control-content {
				background-color: white;
				min-height: 350px;
			}
			
			.mui-control-content .mui-loading {
				margin-top: 50px;
			}
			
			.mui-popup-backdrop {
				position: fixed;
				z-index: 10000;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				-webkit-transition-duration: 400ms;
				transition-duration: 400ms;
				opacity: 0;
				background: rgba(0, 0, 0, 0.6);
			}
			#pay-protocol-content b{
				font-size: 14px;
				display: block;
			}
			.payHint{
				height: 30px;
				margin-top: -15px;
				background: #00D480;
				line-height: 8px;
				font-size: 12px;
				text-align: center;
				vertical-align: middle;
				color:#FFFFFF;
				white-space:nowrap;
				overflow: hidden;
				text-overflow:ellipsis;
			}
			.selectcheckbox{
				display: inline-block;
				position: relative;
			}
			.selectcheckbox img{
				width: 18px;
				height: 18px;
			}
			.selectcheckbox input{
				display: inline-block;
				vertical-align: bottom;
				position: absolute;
				width: 18px;
				height: 18px;
				top:0px;
				opacity: 0;
			}
			.layer{
				vertical-align: top;
				display: inline-block;

			}
			.tongyi{
				width: 80%;
				margin: 10px auto;
			}
		</style>
	</head>

	<body>
		<div class="mui-content">
			<div class="mui-table-view">
				<div class="mui-table-view-cell payHint">
					订单提交成功，请尽快付款，订单将在24小时后自动取消
				</div>
			</div>

			<div class="mui-table-view" id="orderpayinfo" style="margin-top: 0px;height: 130px;">
				<!--
                	作者：offline
                	时间：2017-02-25
                	描述：
             
				<p style="font-size: 14px;padding-left: 15px;padding-top: 15px;">订单编号：*******</p>
				<p style="font-size: 14px;padding-left: 15px;padding-top: 1px;">课程名称：*******</p>
				<p style="font-size: 14px;padding-left: 15px;padding-top: 1px;">应付金额：￥0.00</p>   -->
			</div>

			<div class="btn_div" style="margin-top: 20%;width:100%;">
				<button id="btn_share" type="button" class="mui-btn mui-btn-success  btnself">微信支付</button>
				<div class="mui-content-padded tongyi">
					<div class="selectcheckbox" id="selectcheckbox">
						<img src="/Views/h5/img/select.png" alt="" id="noselect"/>
						<input type="checkbox" name="" id="agreementchecked" value="" checked/>
					</div>
					<p id="agreement" style="font-size:12px;vertical-align:top;display: inline-block">我已阅读并同意<span class="layer"><a href="payment_agree.html">《熊猫中医云课堂用户付费协议》</a></span></p>
				</div>
			</div>
		</div>

		<!--遮罩-->

		<div class="mui-popup-backdrop mui-active" style="display: none;" id="cover_div">

			<div id="pay-protocol-content" style="width: 92%;height: 80%;margin-left: 4%;margin-top: 13%;">
				<div><img id="closex" src="/Views/h5/img/regclose.png" / style="height:35px;margin-left: 85%;margin-bottom: -4px;"></div>
				<div id="" style="height: 52px;background: #00D580;text-align: center;line-height: 52px;color: #fff;">
					熊猫中医云课堂用户协议
				</div>
				<div style="display: block;height: 90%;overflow: auto;padding:8px;background: #fff;">
					<p>欢迎使用熊猫中医云课堂服务，为保障用户权益，请用户在付费之前，详细阅读此服务协议（以下简称“本协议”）所有内容，特别是加粗部分。当用户点选“【我已经阅读并同意《熊猫中医云课堂-用户付费协议》】”，即表示用户同意并承诺遵守本协议。
						本协议内容包括协议正文、本协议下述明确援引的其他协议、熊猫中医云课堂已经发布的或将来可能发布的各类规则。所有规则为本协议不可分割的组成部分，与协议正文具有同等法律效力。
					</p>
					<b>第一条 定义
					</b>
					<p>1、熊猫中医云课堂指熊猫中医(海口)健康科技有限公司所有和经营的有关教育、学习等数字内容聚合、管理和分发的平台产品，旨在为课程发布者及用户提供教学内容的生成、传播和学习等平台服务。
					</p>
					<p>2、收费课程是指由熊猫中医云课堂课程研究院研发定制，并有偿提供给用户的视频、文字、图片等内容。
					</p>
					<p>3、课程发布者是指通过熊猫中医云课堂平台有偿或无偿向用户提供服务或发布其享有合法权益的内容供用户学习、使用的各学科研究院成员。
					</p>
					<b>第二条 本协议的修订
					</b>
					<p>熊猫中医云课堂有权对本协议进行调整或补充，并在熊猫中医云课堂平台（www.ixincheng.com）公告。若用户继续使用熊猫中医云课堂服务的，则视为接受该协议的调整或补充，亦或用户有权终止使用该服务。</p>
					<b>第三条 用户规则
					</b>
					<p>1、用户可在熊猫中医云课堂平台上浏览已经发布的内容信息（包括但不限于收费课程信息等），如用户希望有偿获得该部分内容或服务，则用户需先登录或注册熊猫中医云课堂帐号或通过页面提示,选用其他第三方帐号进行登录。如用户选用其他第三方帐号进行登录的，用户应保证第三方帐号的稳定性、真实性以及可用性，如因第三方帐号原因（如第三方帐号被封号）致使用户无法登录熊猫中医云课堂的，用户应与第三方帐号的所属公司联系。用户在使用熊猫中医云课堂服务时登录的帐号是熊猫中医云课堂确认用户身份的唯一依据。
					</p>
					<p>2、用户理解并同意：熊猫中医云课堂平台提供有偿内容或服务实行先付款后使用的方式，用户及时、足额、合法的支付所需的款项是您使用该协议的有偿内容或服务的前提。
					</p>
					<p>3、课程发布者是指通过熊猫中医云课堂平台有偿或无偿向用户提供服务或发布其享有合法权益的内容供用户学习、使用的各学科研究院成员。<b style="display: inline-block">关于已购买的付费课程视频资源使用时效说明如下：</b></p>
					<b>3.1 视频资源在排除因不可抗力因素导致的损坏、丢失、下架等之外(包含但不仅限于此)，默认为永久有效；
					</b>
					<b>3.2 单次购买成功后的收费课程，可在1年内自己重复学习，无需再次付费；
					</b>
					<b>3.3 已购买的付费视频超过1年时限后，熊猫中医云课堂将收取部分视频存储服务费（≤500元/年）。但请用户注意，在符合相关法律、法规规定的情况下，熊猫中医云课堂有权根据上述规定对您购买的收费课程不予退款。
					</b>
					<b>4、用户知悉并同意，用户无权对已购买的课程进行出售、转让、许可或其他方式使除用户自己以外的第三方（包括但不限于自然人、法人或其他组织）使用其已购买的课程。若用户违反本条规定，则熊猫中医云课堂有权视情况采取如下措施：
					</b>
					<b>4.1 取消用户继续使用该课程的权利；
					</b>
					<b>4.2 限制/冻结用户的帐号；
					</b>
					<b>4.3 要求用户退还其通过出售、转让、许可等其他方式取得的收益；
					</b>
					<b>4.4 其他熊猫中医云课堂可以采取的救济措施。
					</b>
					<b>5、用户了解并同意，熊猫中医云课堂可能会基于自身原因（包括但不限于：更新课程内容、改进课程安排）不定期的对收费课程进行更新而无需经过您的事先同意。
					</b>
					<p>6、用户应保管好自己的帐号和密码（包括但不限于：邮箱帐号），如因用户未保管好自己的帐号和密码而对自己、熊猫中医云课堂造成损害的，用户将负全部责任。另外，用户应对用户帐号中的所有活动和事件负全责。用户可随时改变帐号和密码。用户同意若发现有非法使用用户的帐号或出现安全漏洞的情况，立即通告熊猫中医云课堂，熊猫中医云课堂将会尽力予以妥善解决。
					</p>
					<b>第四条 其他约定	</b>
					<p>1、所有权及知识产权：熊猫中医云课堂平台上所有内容，包括但不限于文字、软件、声音、图片、录像、图表、网站架构、网站画面的安排、网页设计、以及有偿内容或服务均由熊猫中医云课堂或其他权利人依法拥有其知识产权，包括但不限于著作权、商标权、专利权等。非经熊猫中医云课堂或其他权利人书面同意用户不得擅自使用、修改、复制、传播、改变、散布、发行或发表上述内容。如有违反，用户同意承担由此给熊猫中医云课堂、公司或其他权利人造成的一切损失。</p>
					<p>2、通知：所有发给用户的通知都可通过电子邮件、短信、系统消息、常规的信件或在网站显著位置公告的方式进行传送。
					</p>
					<p>3、本协议适用中华人民共和国的法律（不含冲突法）。当本协议的任何内容与中华人民共和国法律相抵触时，应当以法律规定为准，同时相关内容将按法律规定进行修改或重新解释，而本协议其他部分的法律效力不变。
					</p>
					<p>4、本协议自发布之日起实施，并构成用户和熊猫中医云课堂之间的共识。
					</p>
					<p>5、熊猫中医云课堂不行使、未能及时行使或者未充分行使本协议或者按照法律规定所享有的权利，不应被视为放弃该权利，也不影响熊猫中医云课堂在将来行使该权利。
					</p>
					<p>6、如果用户对本协议内容有任何疑问，请发送邮件至我们的工作人员邮箱：<span style="color: #2ac845">bxg_online@itcast.cn</span></p>

				</div>

			</div>
		</div>

	</body>
	<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	<script type="text/javascript" src="/Views/h5/js/mui.min.js"></script>
	<script type="text/javascript" src="/Views/h5/js/common.js"></script>
	<script type="text/javascript">
		(function($, doc) {
			var orderNo = param_orderNo;
			requestService("/bxg/order/getByOrderNo", {
				orderNo: orderNo
			}, function(data) {
				if(data.success) {
					var dataresult = data.resultObject;
					//console.log(dataresult.courseName);
					var orderpayinfo = document.getElementById("orderpayinfo");
					orderpayinfo.innerHTML = '<p style="font-size: 14px;padding-left: 15px;padding-top: 15px;" class="fontcolor_blak">订单编号：' + orderNo + '</p>' +
						'<p style="font-size: 14px;padding-left: 15px;padding-top: 1px;" class="fontcolor_blak">课程名称：' + dataresult.courseName + '</p>' +
						'<p style="font-size: 14px;padding-left: 15px;padding-top: 1px;" class="fontcolor_blak">应付金额：￥' + dataresult.currentPrice + '</p>';
				}

			})
			
			var access  = localStorage.access;
			
			var openid,useid,testurl,urlparm;
			if(access == "brower"){   
				 useid = localStorage.useid;
				 testurl = window.location.href;
			}else{
				 openid = localStorage.openid;
				 useid = localStorage.useid;
				 testurl = window.location.href;
				 urlparm = {
					openid: openid,
					jsconfig_url: testurl
				 }
					requestService("/bxg/wxjs/getWxJsConfig ", urlparm, function(data) {
						if(data.success) {
							var configresult = data.resultObject;
							var jsApiList = configresult.jsApiList;
							var signature = configresult.signature;
							var timestamp = configresult.timestamp;
							var nonceStr = configresult.nonce_str;
							var appId = configresult.appid;

							//timestamp = "'" + timestamp + "'";
							//signature = "'" + signature + "'";
							//nonceStr 	= "'" + nonceStr  + "'";

							//alert('jsApiList=['+jsApiList + ']');
							//alert('signature=['+signature + ']');
							//alert('timestamp=['+timestamp + ']');
							//alert('nonceStr=['+nonceStr + ']');

							wx.config({
								debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
								appId: appId, //appId: 'wx42fe48fd3935151e', //openid, // 必填，公众号的唯一标识
								timestamp: timestamp, // 必填，生成签名的时间戳
								nonceStr: nonceStr, // 必填，生成签名的随机串
								signature: signature, // 必填，签名
								jsApiList: jsApiList // 必填，需要使用的JS接口列表
							});
						}
					});
			}
	
			mui(".btn_div").on('tap', '.btnself', function() {
				//console.log(this.href);
				
				var agreementchecked = document.getElementById("agreementchecked").checked;
								if(agreementchecked) {
									console.log(agreementchecked + '同意');
									//alert("browerUserId"+browerUserId);
									if(access=="brower"){   
										browserPay(useid, orderNo);
									}else{
										qupay(useid, orderNo);
									}
								} else {
									mui.toast("您好，报名课程须同意《熊猫中医云课堂用户付费协议》")
								}
				//location.href = "wait-money.html";
			})

		}(mui, document));
		document.getElementById("selectcheckbox").addEventListener("tap",function(){
			var agreementchecked = document.getElementById("agreementchecked").checked;
			console.log(agreementchecked);
			if(!stringnull(agreementchecked)) {

				document.getElementById("noselect").src = "/Views/h5/img/select.png";

			} else {

				document.getElementById("noselect").src = "/Views/h5/img/noSelect.png";
				return false;
				//
			}
		})
		document.getElementById("closex").addEventListener('tap', function() {
			document.getElementById("cover_div").style.display = "none";
		})
		document.getElementById("agreement").addEventListener('tap', function() {
			document.getElementById("cover_div").style.display = "block";
		})
	</script>

</html>